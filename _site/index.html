<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->





<title>Fanjin Zhang - Homepage</title>







<meta property="og:locale" content="en">
<meta property="og:site_name" content="Fanjin Zhang">
<meta property="og:title" content="Fanjin Zhang">


  <link rel="canonical" href="https://github.com/pages/zfjsail/zfjsail.github.io/">
  <meta property="og:url" content="https://github.com/pages/zfjsail/zfjsail.github.io/">



  <meta property="og:description" content="About me">









<!-- end SEO -->


<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="assets/css/main.css">

<meta http-equiv="cleartype" content="on">
<head>
  <base target="_blank">
</head>
    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="images/icon.png">
<link rel="icon" type="image/png" sizes="16x16" href="images/icon.png">
<link rel="manifest" href="images/site.webmanifest">

<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg masthead__menu-home-item"><a href="#about-me">Homepage</a></li>
          
            <li class="masthead__menu-item"><a href="\#research">Research</a></li>
          
            <li class="masthead__menu-item"><a href="\#publications">Publications</a></li>
          
            <li class="masthead__menu-item"><a href="\#experience">Experience</a></li>
          
            <li class="masthead__menu-item"><a href="\#service">Service</a></li>
          
            <li class="masthead__menu-item"><a href="\#awards">Awards</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    <div id="main" role="main">
      
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    <img src="images/zfj.png" class="author__avatar" alt="Fanjin Zhang">
  </div>

  <div class="author__content">
    <h3 class="author__name">Fanjin Zhang</h3>
    <p class="author__bio">Assistant Professor @ Renmin University of China</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
      <li><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> Beijing, China</li>
      
      
      
      <li><a href="https://www.aminer.cn/profile/5d415c0c7390bff0db70c4b0"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Website</a></li>
      
      
      <li><a href="mailto:fanjinz@ruc.edu.cn"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i> Email</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      <li><a href="https://github.com/zfjsail"><i class="fab fa-fw fa-github" aria-hidden="true"></i>
          Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li><a href="https://scholar.google.com/citations?user=V-e7-ooAAAAJ&hl=en"><i class="fas fa-fw fa-graduation-cap"></i> Google Scholar</a></li>
      
      
      
      
      
      <div style="width: 200px; margin: 0 auto">
        <script type="text/javascript" id="clustrmaps"
          src="//clustrmaps.com/map_v2.js?d=KP2fxf-KI40Mf9ul3qC1DdE8U3rgNNtgxe2lXUfLIOY&cl=ffffff&w=a"></script>
      </div>
    </ul>
  </div>
</div>
  
  </div>

    
      <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
        <meta itemprop="headline" content="">
        <div class="page__inner-wrap">
          <section class="page__content" itemprop="text">
            <!-- ## About Me -->

<p>I am Fanjin Zhang (张帆进), an Assistant Professor in the <a href="http://info.ruc.edu.cn/">School of Information</a>, <a href="https://www.ruc.edu.cn/">Renmin University of China</a>. I received my Ph.D. degree from <a href="https://www.tsinghua.edu.cn/en/">Tsinghua University</a>, advised by Prof. <a href="https://keg.cs.tsinghua.edu.cn/jietang/">Jie Tang</a>, and my bachelor degree from <a href="https://www.nju.edu.cn/">Nanjing University</a>.</p>

<p>My research interests generally include data mining, knowledge graph, and large language models, with an emphasis on developing <strong>scalable</strong> and <strong>lightweight</strong> data mining algorithms
primarily on academic knowledge graph to accelerate academic research and scientific innovation.
For a complete and up-to-date publication list, see my Google Scholar profile <a href="https://scholar.google.com/citations?user=V-e7-ooAAAAJ"><img id="google-scholar-citation-badge" src="https://img.shields.io/badge/citations-loading-lightgrey?style=flat&amp;logo=Google%20Scholar&amp;labelColor=f6f6f6&amp;color=9cf&amp;label=citations" alt="Google Scholar citations loading" /></a>.</p>

<p>I am looking for <u>highly-motivated</u> students to work with me on the area of AI for research. If interested, please drop me a message by email.</p>

<h2 id="research">Research</h2>

<div class="paper-box"><div class="paper-box-image"><div><div class="badge">LLM Agent for Academic Data</div><img src="images/aminer-dr.png" alt="sym" width="100%" />


</div>
</div>
<div class="paper-box-text">

    <p><strong>LLM Agent for Academic Data</strong></p>

    <p>Large Language Model (LLM) Agents are revolutionizing the development of academic applications, making them smarter and more accessible. Our current focus is on pioneering technologies and products in areas such as <a href="https://aminer.org"><strong>AI-driven Academic Search</strong></a>, <a href="https://www.aminer.cn/chat/s/explain"><strong>Intelligent Paper Reading</strong></a>, and <a href="https://aminer.org/open/research"><strong>AMiner Deep Research</strong></a>. Our goal is to create powerful agents that excel in tasks like planning, searching, summarizing, and reflecting with high levels of efficiency and effectiveness.</p>

  </div>
</div>

<div class="paper-box"><div class="paper-box-image"><div><div class="badge">Author Name Disambiguation (AND)</div><img src="images/whoiswho.png" alt="sym" width="100%" />


</div>
</div>
<div class="paper-box-text">

    <p><strong>Name Disambiguation</strong>, a core challenge in academic systems, is now facing greater challenges with the rapid growth of papers. We develop WhoIsWho, a million-scale human-annotated author name disambiguation benchmark, decompose the AND problem into several subtasks, and develop specialized algorithms for each subtask.</p>

    <ul>
      <li><img src="https://img.shields.io/badge/KDD-2023-blue" alt="" /> WhoIsWho Benchmark:  <a href="https://github.com/THUDM/WhoIsWho">[code &amp; data]</a></li>
      <li>From-Scratch Name Disambiguation:
        <ul>
          <li><img src="https://img.shields.io/badge/WWW-2024-blue" alt="" /> BOND: an end-to-end method that bootstraps the global clustering and local metric learning. <a href="https://github.com/THUDM/WhoIsWho">[code]</a></li>
          <li><img src="https://img.shields.io/badge/KDD-2018-blue" alt="" /> A representation learning method that incorporates both global and local information between documents.  <a href="https://github.com/neozhangthe1/disambiguation">[code]</a></li>
        </ul>
      </li>
      <li>INcorrect Assignment Detection: <img src="https://img.shields.io/badge/KDD-2025-blue" alt="" /> GuARD: a multi-modal-like multi-turn instruction tuning framework. <a href="https://github.com/THUDM/WhoIsWho/tree/main/mind">[code &amp; data &amp; model]</a></li>
    </ul>

  </div>
</div>

<div class="paper-box"><div class="paper-box-image"><div><div class="badge">Paper Source Tracing (PST)</div><img src="images/pst.png" alt="sym" width="100%" />


</div>
</div>
<div class="paper-box-text">

    <p><strong>Paper Source Tracing (PST)</strong></p>

    <p>Comprehending the patterns of scientific evolution, such as the trends of topics and the flow of ideas,
are critical for researchers in knowledge discovery. However, a notable gap persists between the large-scale and semantically rich citation relations and the backbone structure of scientific evolution. To bridge this gap, we construct a high-quality and ever-increasing dataset PST-Bench in computer science. Addtionally, we present a live demo to automatically trace the source of any target paper based on its full text. <a href="https://github.com/THUDM/paper-source-trace">[code &amp; data]</a>  <a href="http://pst.aminer.cn">[demo]</a></p>

  </div>
</div>

<div class="paper-box"><div class="paper-box-image"><div><div class="badge">Open Academic Graph (OAG)</div><img src="images/oab-overview-en.png" alt="sym" width="100%" />


</div>
</div>
<div class="paper-box-text">

    <p><strong>Open Academic Graph (OAG)</strong></p>

    <p>The overarching goal of academic data mining is to deepen our comprehension of the development, nature, and trends of science, unlocking immense value across scientific, technological, and educational domains.
We release a series of meticulously curated academic benchmarks to foster the develeopment of this field.</p>

    <ul>
      <li><img src="https://img.shields.io/badge/KDD-2019-blue" alt="" />  <img src="https://img.shields.io/badge/TKDE-2023-blue" alt="" /> OAG: A collection of billion-scale academic knowledge graphs. <a href="https://www.aminer.cn/open/article?id=5965cf249ed5db41ed4f52bf">[data]</a></li>
      <li><img src="https://img.shields.io/badge/KDD-2024-blue" alt="" /> OAG-Bench: a comprehensive, multi-aspect, and fine-grained human-curated benchmark built
on OAG, covering 10 tasks, 20 datasets, 70+baselines, and 120+experimental results to date. <a href="https://github.com/zfjsail/OAG-Bench/tree/main">[code]</a>  <a href="https://www.aminer.cn/data/">[data]</a> <a href="https://www.biendata.xyz/kdd2024/">[data challenge]</a></li>
    </ul>
  </div>
</div>

<h2 id="publications">Publications</h2>

<p>(† corresponding authors)</p>

<p><strong>RPC-Bench: A Fine-grained Benchmark for Research Paper Comprehension</strong><br />
<em>arXiv:2601.14289</em>  <br />
Yelin Chen, <strong>Fanjin Zhang†</strong>, Suping Sun, Yunhe Pang, Yuanchun Wang, Jian Song, Xiaoyan Li, Lei Hou, Shu Zhao, Jie Tang, Juanzi Li<br />
<a href="https://arxiv.org/pdf/2601.14289">[pdf]</a> <a href="https://rpc-bench.github.io/">[code &amp; data]</a></p>

<p><strong>Small Language Model Makes an Effective Long Text Extractor</strong>   <br />
<em>The 39th Annual AAAI Conference on Artificial Intelligence (<strong>AAAI</strong>) 2025</em>    <br />
Yelin Chen, <strong>Fanjin Zhang†</strong>, Jie Tang    <br />
<a href="https://arxiv.org/pdf/2502.07286">[pdf]</a>  <a href="https://github.com/THUDM/scholar-profiling/tree/main/sener">[code &amp; data]</a></p>

<p><strong>GuARD: Effective Anomaly Detection through a Text-Rich and Graph-Informed Language Model</strong>        <br />
<em>The 31st ACM SIGKDD Conference on Knowledge Discovery and Data Mining (<strong>KDD</strong>) 2025</em>        <br />
Yunhe Pang, Bo Chen, <strong>Fanjin Zhang†</strong>, Yanghui Rao, Evgeny Kharlamov, Jie Tang    <br />
<a href="https://arxiv.org/pdf/2412.03930">[pdf]</a>  <a href="https://github.com/THUDM/WhoIsWho/tree/main/mind">[code &amp; data &amp; model]</a></p>

<p><strong>SAM Decoding: Speculative Decoding via Suffix Automaton</strong>  <br />
<em>The 63rd Annual Meeting of the Association for Computational Linguistics (<strong>ACL</strong>) 2025</em>    <br />
Yuxuan Hu, Ke Wang, Xiaokang Zhang, <strong>Fanjin Zhang</strong>, Cuiping Li, Hong Chen, Jing Zhang  <br />
<a href="https://arxiv.org/pdf/2411.10666">[pdf]</a>  <a href="https://github.com/hyx1999/SAM-Decoding">[code]</a></p>

<p><strong>OAG-Bench: A Human-Curated Benchmark for Academic Graph Mining</strong>     <br />
<em>The 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (<strong>KDD</strong>) 2024</em>   <br />
<strong>Fanjin Zhang</strong>, Shijie Shi, Yifan Zhu, Bo Chen, Yukuo Cen, Jifan Yu, Yelin Chen, Lulu Wang, Qingfei Zhao, Yuqing Cheng, Tianyi Han, Yuwei An, Dan Zhang, Weng Lam Tam, Kun Cao, Yunhe Pang, Xinyu Guan, Huihui Yuan, Jian Song, Xiaoyan Li, Yuxiao Dong, and Jie Tang   <br />
<a href="https://arxiv.org/pdf/2402.15810">[pdf]</a>  <a href="https://github.com/zfjsail/OAG-Bench/tree/main">[code]</a>  <a href="https://www.aminer.cn/data/">[data]</a> <a href="https://www.biendata.xyz/kdd2024/">[data challenge]</a></p>

<p><strong>PST-Bench: Tracing and Benchmarking the Source of Publications</strong>  <br />
<em>arXiv:2402.16009</em>  <br />
<strong>Fanjin Zhang</strong>, Kun Cao, Yukuo Cen, Jifan Yu, Da Yin, Jie Tang   <br />
<a href="https://arxiv.org/pdf/2402.16009">[pdf]</a>  <a href="https://github.com/THUDM/paper-source-trace">[code &amp; data]</a>     <a href="http://pst.aminer.cn">[demo]</a></p>

<p><strong>BOND: Bootstrapping From-Scratch Name Disambiguation with Multi-task Promoting.</strong>   <br />
<em>The Web Conference (<strong>WWW</strong>) 2024</em>   <br />
Yuqing Cheng, Bo Chen, <strong>Fanjin Zhang†</strong>, and Jie Tang   <br />
<a href="https://arxiv.org/pdf/2404.08322">[pdf]</a> <a href="https://github.com/THUDM/WhoIsWho">[code]</a></p>

<p><strong>Web-Scale Academic Name Disambiguation: the WhoIsWho Benchmark, Leaderboard, and Toolkit</strong>    <br />
<em>The 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (<strong>KDD</strong>) 2023</em>   <br />
Bo Chen, Jing Zhang, <strong>Fanjin Zhang</strong>, Tianyi Han, Yuqing Cheng, XiaoYan Li, Yuxiao Dong, and Jie Tang    <br />
<a href="http://keg.cs.tsinghua.edu.cn/jietang/publications/KDD23-Chen-WhoIsWho.pdf">[pdf]</a>  <a href="https://github.com/THUDM/WhoIsWho">[code &amp; data]</a></p>

<p><strong>OAG: Linking Entities across Large-Scale Heterogeneous Knowledge Graphs</strong>  <br />
<em>IEEE Transactions on Knowledge and Data Engineering (<strong>TKDE</strong>) 2022</em>    <br />
<strong>Fanjin Zhang</strong>, Xiao Liu, Jie Tang, Yuxiao Dong, Peiran Yao, Jie Zhang, Xiaotao Gu, Yan Wang, Evgeny Kharlamov, Bin Shao, Rui Li, and Kuansan Wang   <br />
<a href="https://ieeexplore.ieee.org/abstract/document/9950622">[pdf]</a> <a href="https://www.aminer.cn/oag-2-1">[data]</a></p>

<p><strong>Understanding WeChat User Preferences and “Wow” Diffusion</strong>  <br />
<em>IEEE Transactions on Knowledge and Data Engineering (<strong>TKDE</strong>) 2021</em>  <br />
<strong>Fanjin Zhang</strong>, Jie Tang, Xueyi Liu, Zhenyu Hou, Yuxiao Dong, Jing Zhang, Xiao Liu, Ruobing Xie, Kai Zhuang, Xu Zhang, Leyu Lin, and Philip S. Yu.   <br />
<a href="https://arxiv.org/pdf/2103.02930.pdf">[pdf]</a> <a href="https://github.com/zfjsail/wechat-wow-analysis">[code]</a></p>

<p><strong>Self-supervised Learning: Generative or Contrastive</strong>   <br />
<em>IEEE Transactions on Knowledge and Data Engineering (<strong>TKDE</strong>) 2021</em>  <br />
Xiao Liu, <strong>Fanjin Zhang</strong>, Zhenyu Hou, Li Mian, Zhaoyu Wang, Jing Zhang, and Jie Tang  <br />
<a href="https://arxiv.org/pdf/2006.08218.pdf">[pdf]</a></p>

<p><strong>OAG_know: Self-supervised Learning for Linking Knowledge Graphs</strong>  <br />
<em>IEEE Transactions on Knowledge and Data Engineering (<strong>TKDE</strong>) 2021</em>  <br />
Xiao Liu, Li Mian, Yuxiao Dong, <strong>Fanjin Zhang</strong>, Jing Zhang, Jie Tang, Peng Zhang, Jibing Gong, and Kuansan Wang  <br />
<a href="http://keg.cs.tsinghua.edu.cn/jietang/publications/TKDE21-Liu-et-al-OAG-know.pdf">[pdf]</a> <a href="https://github.com/Xiao9905/OAG_know">[code]</a></p>

<p><strong>OAG: Toward Linking Large-scale Heterogeneous Entity Graphs</strong>  <br />
<em>The 25th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (<strong>KDD</strong> <span style="color:red"><strong>Oral</strong></span>) 2019</em>  <br />
<strong>Fanjin Zhang</strong>, Xiao Liu, Jie Tang, Yuxiao Dong, Peiran Yao, Jie Zhang, Xiaotao Gu, Yan Wang, Bin Shao, Rui Li, and Kuansan Wang  <br />
<a href="http://keg.cs.tsinghua.edu.cn/jietang/publications/KDD19-Zhang-et-al-Open_Academic_Graph.pdf">[pdf]</a> <a href="https://github.com/zfjsail/OAG">[code]</a> <a href="https://www.aminer.cn/open/article?id=5965cf249ed5db41ed4f52bf">[data &amp; website]</a></p>

<p><strong>Name Disambiguation in AMiner: Clustering, Maintenance, and Human in the Loop</strong>   <br />
<em>The 24th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (<strong>KDD</strong> <span style="color:red"><strong>Oral</strong></span>) 2018</em>   <br />
Yutao Zhang, <strong>Fanjin Zhang</strong>, Peiran Yao, and Jie Tang   <br />
<a href="http://keg.cs.tsinghua.edu.cn/jietang/publications/kdd18_yutao-AMiner-Name-Disambiguation.pdf">[pdf]</a> <a href="https://github.com/neozhangthe1/disambiguation">[code]</a></p>

<p><strong>Profiling Web Users Using Big Data</strong>  <br />
<em>Social Network Analysis and Mining (<strong>SNAM</strong>) 2018</em>  <br />
Xiaotao Gu, Hong Yang, Jie Tang, Jing Zhang, <strong>Fanjin Zhang</strong>, Debing Liu, Wendy Hall, and Xiao Fu  <br />
<a href="http://keg.cs.tsinghua.edu.cn/jietang/publications/SNAM18-user-profiling-with-big-data.pdf">[pdf]</a></p>

<h2 id="experience">Experience</h2>

<p>2025.11 - Now, Assistant Professor, Renmin University of China, Beijing, China</p>

<p>2024.01 - 2025.11, Postdoctoral Researcher, Tsinghua University, Beijing, China</p>

<p>2023.07 - 2023.12,  Algorithm Engineer, Zhipu AI, Beijing, China</p>

<p>2017.09 - 2023.06, Ph.D. in Computer Science and Technology, Tsinghua University, Beijing, China</p>

<ul>
  <li>
    <p>2019.07 - 2020.11, Research Intern, Tencent, Beijing, China</p>
  </li>
  <li>
    <p>2017.05 - 2017.09, Research Intern, Microsoft Research Asia, Beijing, China</p>
  </li>
</ul>

<p>2013.09 - 2017.06, B.E. in Computer Science and Technology, Nanjing University, Nanjing, China</p>

<h2 id="service">Service</h2>

<p><strong>PC Member</strong>: <br />
2025: KDD <br />
2024: WSDM, AAAI, WWW, KDD<br />
2023: WSDM, AAAI <br />
2020: ECML-PKDD</p>

<p><strong>Reviewer</strong>: IEEE Transactions on Knowledge and Data Engineering (<em>TKDE</em>), 
  IEEE Transactions on Neural Networks and Learning Systems (<em>TNNLS</em>),
  IEEE Transactions on Big Data (<em>TBD</em>), 
  IEEE Transactions on Computational Social Systems (<em>TCSS</em>), 
  Social Network Analysis and Mining (<em>SNAM</em>),
  AI Open</p>

<h2 id="awards">Awards</h2>
<p>Excellent Graduate Student from Department of Computer Science and Technology, Tsinghua University (2023) <br />
Alumnus Scholarship of Tsinghua University (2021 &amp; 2019)<br />
Second Prize of the National Science and Technology Progress Award (2020)<br />
CAAI Annual Outstanding Scientific and Technological Achievement Award (2020)<br />
National Scholarship (2014)</p>

          </section>
        </div>
      </article>
    </div>

    <script src="assets/js/main.min.js"></script>



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', "");
</script>


<script>
    function initGoogleScholarStats() {
        var gsRepository = 'zfjsail/zfjsail.github.io';
        var gsDataPaths = [
            '/gs_data.json',
            '/gs_data_shieldsio.json',
            '/google-scholar-stats/gs_data.json',
            '/google-scholar-stats/gs_data_shieldsio.json',
            'https://cdn.jsdelivr.net/gh/' + gsRepository + '@google-scholar-stats/gs_data.json',
            'https://cdn.jsdelivr.net/gh/' + gsRepository + '@google-scholar-stats/gs_data_shieldsio.json',
            'https://cdn.jsdelivr.net/gh/' + gsRepository + '@google-scholar-stats/results/gs_data.json',
            'https://cdn.jsdelivr.net/gh/' + gsRepository + '@google-scholar-stats/results/gs_data_shieldsio.json',
            'https://raw.githubusercontent.com/' + gsRepository + '/google-scholar-stats/gs_data.json',
            'https://raw.githubusercontent.com/' + gsRepository + '/google-scholar-stats/gs_data_shieldsio.json',
            'https://raw.githubusercontent.com/' + gsRepository + '/google-scholar-stats/results/gs_data.json',
            'https://raw.githubusercontent.com/' + gsRepository + '/google-scholar-stats/results/gs_data_shieldsio.json',
            'https://cdn.jsdelivr.net/gh/' + gsRepository + '@main/google-scholar-stats/gs_data.json',
            'https://raw.githubusercontent.com/' + gsRepository + '/main/google-scholar-stats/gs_data.json',
            'https://raw.githubusercontent.com/' + gsRepository + '/main/gs_data.json'
        ];
        var cacheKey = 'google-scholar-stats-cache-v1';
        var cacheTtlMs = 24 * 60 * 60 * 1000;

        function parseJsonResponse(response) {
            return response.text().then(function (text) {
                var trimmed = text.trim();
                if (!trimmed.startsWith('{') && !trimmed.startsWith('[')) {
                    throw new Error('Non-JSON response');
                }
                return JSON.parse(trimmed);
            });
        }

        function formatNumber(value) {
            if (typeof value === 'string' && /\d+\+$/.test(value.trim())) {
                return value.trim();
            }
            var num = parseInt(value, 10);
            return isNaN(num) ? value : num.toString();
        }

        function normalizeCitationValue(value) {
            if (value === null || value === undefined) {
                return value;
            }
            if (typeof value === 'number') {
                return value.toString();
            }
            var raw = String(value);
            if (/\d+\+$/.test(raw.trim())) {
                return raw.trim();
            }
            var onlyDigits = raw.replace(/\D/g, '');
            if (onlyDigits === '') {
                return raw;
            }
            return onlyDigits;
        }

        function getRawCitation(data) {
            if (!data) {
                return null;
            }
            var raw = data['citedby'];
            if ((raw === null || raw === undefined || String(raw).trim() === '') && data['message'] !== undefined) {
                raw = data['message'];
            }
            return raw;
        }

        function hasUsableCitation(data) {
            var raw = getRawCitation(data);
            if (raw === null || raw === undefined) {
                return false;
            }
            var normalized = String(normalizeCitationValue(raw)).trim();
            if (!normalized || normalized.toUpperCase() === 'N/A') {
                return false;
            }
            return !isNaN(parseInt(normalized, 10));
        }

        function isApproxCitation(data) {
            var raw = getRawCitation(data);
            return typeof raw === 'string' && raw.indexOf('+') >= 0;
        }

        function extractProfileCitations() {
            var scholarProfile = 'https://scholar.google.com/citations?user=V-e7-ooAAAAJ&hl=en';
            if (!scholarProfile) {
                return Promise.reject(new Error('No scholar profile configured'));
            }
            var path = scholarProfile.replace('https://scholar.google.com', '');
            var mirrorUrl = 'https://r.jina.ai/http://scholar.google.com' + path;
            return fetch(mirrorUrl).then(function (response) {
                if (!response.ok) {
                    throw new Error('Profile fetch failed');
                }
                return response.text();
            }).then(function (text) {
                var match = text.match(/Citations\s+([0-9,]+)/i);
                if (!match || !match[1]) {
                    throw new Error('Citation value not found in mirrored page');
                }
                var n = parseInt(match[1].replace(/,/g, ''), 10);
                if (isNaN(n)) {
                    throw new Error('Cannot parse mirrored citation value');
                }
                return n;
            });
        }

        function setCitationData(data, isCached) {
            window.googleScholarData = data;

            var rawCitations = getRawCitation(data);
            var approx = false;
            if (typeof rawCitations === 'string' && rawCitations.indexOf('+') >= 0) {
                approx = true;
            }

            var totalCitation = formatNumber(normalizeCitationValue(rawCitations));
            var totalCitationElement = document.getElementById('total_cit');
            if (totalCitationElement) {
                totalCitationElement.innerHTML = totalCitation;
            }

            var badgeElement = document.getElementById('google-scholar-citation-badge');
            if (badgeElement) {
                if (!isNaN(parseInt(totalCitation, 10))) {
                    var badgeBase = 'https://img.shields.io/badge/citations-' + encodeURIComponent(String(totalCitation)) + '-9cf';
                    var badgeParams = '?logo=Google%20Scholar&labelColor=f6f6f6&color=9cf&style=flat&label=citations';
                    if (approx) {
                        badgeParams += '&label=~citations';
                    }
                    if (isCached) {
                        badgeParams += '&labelColor=dddddd';
                    }
                    badgeElement.src = badgeBase + badgeParams;
                    badgeElement.alt = 'Google Scholar citations: ' + totalCitation + (approx ? ' (approximate)' : '') + (isCached ? ' (cache)' : '');
                } else {
                    var fallbackCitation = totalCitation;
                    if (fallbackCitation === null || fallbackCitation === undefined || String(fallbackCitation).trim() === '') {
                        fallbackCitation = 'N/A';
                    }
                    badgeElement.src = 'https://img.shields.io/badge/citations-' + encodeURIComponent(String(fallbackCitation)) + '-lightgrey?style=flat&logo=Google%20Scholar&labelColor=f6f6f6&label=citations';
                    badgeElement.alt = 'Google Scholar citations: ' + fallbackCitation + (isCached ? ' (cache)' : '');
                }
            }

            var citationEles = document.getElementsByClassName('show_paper_citations');
            Array.prototype.forEach.call(citationEles, function (element) {
                var paperId = element.getAttribute('data');
                if (data['publications'] && data['publications'][paperId]) {
                    var numCitations = data['publications'][paperId]['num_citations'];
                    element.innerHTML = '| Citations: ' + numCitations;
                } else {
                    element.innerHTML = '';
                }
            });

            document.dispatchEvent(new CustomEvent('google-scholar-stats-loaded', { detail: data }));
        }

        function renderFallback() {
            var badgeElement = document.getElementById('google-scholar-citation-badge');
            if (badgeElement) {
                badgeElement.src = 'https://img.shields.io/badge/citations-not%20found-lightgrey?style=flat&logo=Google%20Scholar&labelColor=f6f6f6&label=citations';
                badgeElement.alt = 'Google Scholar citations: not found';
            }
            var totalCitationElement = document.getElementById('total_cit');
            if (totalCitationElement) {
                totalCitationElement.innerHTML = 'N/A';
            }
        }

        function setFromCache() {
            try {
                var raw = localStorage.getItem(cacheKey);
                if (!raw) {
                    return false;
                }
                var cache = JSON.parse(raw);
                if (!cache || !cache.data || !cache.timestamp || (Date.now() - cache.timestamp) > cacheTtlMs) {
                    return false;
                }
                if (!hasUsableCitation(cache.data) || isApproxCitation(cache.data)) {
                    return false;
                }
                setCitationData(cache.data, true);
                return true;
            } catch (error) {
                return false;
            }
        }

        function saveCache(data) {
            try {
                localStorage.setItem(cacheKey, JSON.stringify({
                    timestamp: Date.now(),
                    data: data
                }));
            } catch (error) {
                // Ignore storage errors (private mode / quota).
            }
        }

        function fetchFromUrl(url, allowApprox) {
            var timeoutMs = 6000;
            var controller = new AbortController();
            var timeoutId = setTimeout(function () {
                controller.abort();
            }, timeoutMs);

            return fetch(url, { signal: controller.signal }).then(function (response) {
                clearTimeout(timeoutId);
                if (!response.ok) {
                    throw new Error('HTTP ' + response.status);
                }
                return parseJsonResponse(response).then(function (data) {
                    if (!hasUsableCitation(data)) {
                        throw new Error('Citation unavailable in source');
                    }
                    if (!allowApprox && isApproxCitation(data)) {
                        throw new Error('Approximate citation skipped');
                    }
                    return data;
                });
            }).catch(function (error) {
                clearTimeout(timeoutId);
                throw error;
            });
        }

        function fetchScholarStats(index, allowApprox) {
            if (index >= gsDataPaths.length) {
                return Promise.reject(new Error('All data sources failed'));
            }
            return fetchFromUrl(gsDataPaths[index], allowApprox).catch(function () {
                return fetchScholarStats(index + 1, allowApprox);
            });
        }

        var hasCache = setFromCache();
        if (!hasCache) {
            var badgeElement = document.getElementById('google-scholar-citation-badge');
            if (badgeElement) {
                badgeElement.src = 'https://img.shields.io/badge/citations-loading...-lightgrey?style=flat&logo=Google%20Scholar&labelColor=f6f6f6&label=citations';
                badgeElement.alt = 'Google Scholar citations: loading';
            }
        }

        fetchScholarStats(0, false).catch(function () {
            return fetchScholarStats(0, true);
        }).then(function (data) {
            setCitationData(data, false);
            saveCache(data);
            if (isApproxCitation(data)) {
                extractProfileCitations().then(function (actualCount) {
                    data['citedby'] = actualCount;
                    setCitationData(data, false);
                    saveCache(data);
                }).catch(function () {
                    // Keep approximate value if profile probe fails.
                });
            }
        }).catch(function () {
            if (!hasCache) {
                renderFallback();
            }
        });
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initGoogleScholarStats);
    } else {
        initGoogleScholarStats();
    }
</script>



  </body>
</html>
